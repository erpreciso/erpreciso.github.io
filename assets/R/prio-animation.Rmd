---
title: "Animazione dal dataset PRIO"
excerpt: ""
output:
  md_document:
    variant: markdown_github
    preserve_yaml: true
    
---
    
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Scopo di questa pagina e' la creazione di un'animazione utilizzando il pacchetto `gganimate`.

Usero' dati provenienti dal [PRIO](https://www.prio.org/), il **Peace Research Institute Oslo** sui conflitti armati.

> Gleditsch, Nils Petter; Peter Wallensteen, Mikael Eriksson, Margareta Sollenberg & Håvard Strand, 2002. ‘Armed Conflict 1946–2001: A New Dataset’, Journal of Peace Research 39(5): 615–637.

## Carico i dati

Scarico il dataset dalla pagina del [Uppsala Conflict Data Program](http://www.pcr.uu.se/research/UCDP/) in formato `Rdata`.

```{r}
library(tidyverse)
load("~/Downloads/ged50.Rdata")
db <- tbl_df(ged50)
world <- map_data("world")
```


# Mantengo solo data e coordinate, e un campione di 100 records

```{r}
names(db)
```

```{r}
sub <- db %>% 
  select(latitude,
         longitude,
         year,
         nkill = best_est) %>% 
  # sample_n(10) %>%
  arrange(year) 
summary(sub)
```

Non ci sono valori mancanti.


## Animazione

Il mio obiettivo e' un risultato simile a quello visto a questo link, [https://www.kaggle.com/tentotheminus9/d/tentotheminus9/good-morning-tweets/good-morning-twitter-animation/code](https://www.kaggle.com/tentotheminus9/d/tentotheminus9/good-morning-tweets/good-morning-twitter-animation/code), ma utilizzando il pacchetto `gganimate` di [David Robinson](http://varianceexplained.org/), installato da [github](https://github.com/dgrtwo/gganimate)


```{r anim, interval=0.1, fig.show="animate"}
p <- ggplot() +
  geom_path(data = world, aes(x = long,
                              y = lat,
                              group = group)) +
  coord_equal() +
  labs(title = "Persone uccise in conflitti armati") +
  scale_y_continuous(labels = scales::comma) +
  scale_colour_continuous(labels = scales::comma) +
  geom_point(data = sub,
             aes(x = longitude,
                 y = latitude,
                 size = nkill,
                 frame = year,
                 cumulative = TRUE),
             color = "red",
             alpha = 0.3)
gganimate::gganimate(p)
```

# Altre risorse:

* il pacchetto `animation` [https://cran.r-project.org/web/packages/animation/animation.pdf](https://cran.r-project.org/web/packages/animation/animation.pdf)

* utilizzare correttamente le opzioni in `knitr` [http://stackoverflow.com/questions/12038893/combining-r-markdown-and-animation-package#12039871](http://stackoverflow.com/questions/12038893/combining-r-markdown-and-animation-package#12039871)