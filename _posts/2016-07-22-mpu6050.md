---
title: MPU6050
date: 2016-07-22 22:35:31 +02:00
tags: elettronica

---

# Introduzione

Il MPU6050 è un microprocessore contenente giroscopi e accellerometri. Il mio obiettivo è ottenere un flusso di dati da poter essere elaborati per calcolare la posizione assoluta del sensore mediante [navigazione stimata](https://it.wikipedia.org/wiki/Navigazione_stimata){:target "_blank"}. In questo articolo mi limito al collegamento del microprocessore ad Arduino ed alla visualizzazione, su monitor, dell'orientamento del sensore rispetto ai tre assi.

Il maggior contributo viene dal tutorial presente sul sito [geekmomprojects](http://www.geekmomprojects.com/mpu-6050-dmp-data-from-i2cdevlib/){:target="_blank"}.

Invece di lavorare con i dati grezzi di accellerometro e giroscopio, uso quelli elaborati dal DMP (Digital Motion Processor) integrato nel microprocessore: lo interfaccio con Arduino mediante il bus **I2C**, usando la libreria I2Cdev di [Jeff Rowberg](https://github.com/jrowberg/i2cdevlib){:target="_blank"}. Visualizzo i dati con il software [Processing](https://processing.org/){:target="_blank"}, utilizzando uno sketch (file di codice utilizzato da Processing) disponibile nella repository di Jeff Rowberg.

# Materiali

## Software

* Linux

```
uname -mrs

> Linux 4.10.0-30-generic x86_64

lsb_release -a

> LSB Version:	core-9.20160110ubuntu5-amd64:core-9.20160110ubuntu5-noarch:security-9.20160110ubuntu5-amd64:security-9.20160110ubuntu5-noarch
> Distributor ID:	Ubuntu
> Description:	Ubuntu 17.04
> Release:	17.04
> Codename:	zesty
```

* [Processing 3.3.5](https://processing.org/){:target="_blank"}
* [Arduino IDE 1.8.3](http://www.arduino.org/downloads){:target="_blank"}


## Hardware

* [MPU6050](http://playground.arduino.cc/Main/MPU-6050){:target="_blank"}
* [Arduino Uno](https://www.arduino.cc/en/Main/ArduinoBoardUno){:target="_blank"}
* basetta sperimentale
* cavetti per collegare il micro ad Arduino
* cavo USB per collegare Arduino al laptop

![MPU6050 sulla basetta sperimentale]({{ site.url }}/assets/images/mpu6050/mpu6050_breadboard.png)


# Messa in moto

Collega i pin dal micro ad Arduino secondo questo schema:

  + **VCC** a 5v;
  + **GND** a ground;
  + **SCL** (clock del I2C) al pin A5;
  + **SDA** (serial data) al pin A4;
  + **INT** al pin 2.

![collegamenti visualizzati in Fritzing]({{ site.url }}/assets/images/mpu6050/mpu6050_bb.png)

![collegamenti sulla basetta sperimentale]({{ site.url }}/assets/images/mpu6050/breadboard_medium.png)


Installa le librerie [I2Cdev](https://github.com/jrowberg/i2cdevlib/tree/master/Arduino/I2Cdev){:target="_blank"} e [MPU6050](https://github.com/jrowberg/i2cdevlib/tree/master/Arduino/MPU6050){:target="_blank"} dalla [repository i2cdevlib](https://github.com/jrowberg/i2cdevlib){:target="_blank"}, scaricando l'intera repository come ZIP e importando le cartelle `I2Cdev-master/Arduino/MPU6050` e `I2Cdev-master/Arduino/I2CDEV` in `Import Library`.

![importa libreria]({{ site.url }}/assets/images/mpu6050/github-jrowberg-download.png){:target="_blank"}

Apri l'esempio MPU6050_DMP6

![importa esempio]({{ site.url }}/assets/images/mpu6050/example.png){:target="_blank"}

Togli il commento da 

`#define OUTPUT_TEAPOT`

and comment

`#define OUTPUT_READABLE_YAWPITCHROLL`

![Code commented]({{ site.url }}/assets/images/mpu6050/arduino_code.png)

Compila e verifica che non ci siano errori.

Attiva la libreria `toxiclibs`, prerequisito per lo sketch di Processing ([toxiclibs.org](http://toxiclibs.org/){:target="_blank"}) tramite `Processing - Import Library`.

![Importa toxilibs]({{ site.url }}/assets/images/mpu6050/toxilibs.png)

Installa lo sketch in Processing scaricandolo dall'[esempio MD6 nella repository i2cdevlib](https://github.com/jrowberg/i2cdevlib/blob/master/Arduino/MPU6050/examples/MPU6050_DMP6/Processing/MPUTeapot/MPUTeapot.pde){:target="_blank"}.

Controlla che la porta in cui Arduino è collegato sia la stessa letta da Processing. Nel mio caso, la porta è ACM0, e nella lista è indicizzata come `0`.

![porta di Arduino]({{ site.url }}/assets/images/mpu6050/port.png)

Carica lo sketch da Arduino IDE a Arduino, lancia lo sketch in Processing, e guarda il risultato. Dopo circa 10 secondi in cui il microprocessore si calibra, puoi vedere la forma generata da processing orientarsi seguendo il movimento del sensore.

Il video qui sotto fu ripreso utilizzando software montato su Windows, ma il risultato in Linux è esattamente lo stesso.

{% include youtube.html id="39PVdvu9n1k" %}
