---
title: Creare un sito web con Jekyll
date: 2017-08-11
lang: it
tags: jekyll
ref: jekyll
excerpt: Passo dopo passo, creare un sito con Jekyll e pubblicarlo mediante GitHub

---

# Crea un sito in Jekyll e pubblicalo usando GitHub

Quest'articolo descrive come creare un sito come questo utilizzando strumenti collaborativi open source, [Jekyll](http://jekyllrb.com/){:target="_blank"} e [GitHub](https://github.com/){:target="_blank"}.

Vengono usati i linguaggi [Liquid](#ref_liquid), [Markdown](#ref_markdown) e [YAML](#ref_yaml), mentre HTML e CSS non sono necessari se si utilizza il tema base, [minima](https://jekyll.github.io/minima/){:target="_blank"}.

Il tutorial è costruito su piattaforma Linux: gli utenti Windows dovranno modificare leggermente alcuni passaggi, ma i punti fondamentali sono gli stessi.

## Installa la piattaforma

Jekyll è una [gemma del linguaggio Ruby](https://en.wikipedia.org/wiki/Ruby_(programming_language)#Repositories_and_libraries){:target="_blank"}, quindi necessita dello stesso per poter essere fatto funzionare.

Una possibilitá è [installarlo come utente locale](https://unix.stackexchange.com/a/36874){:target="_blank"}, in modo da non richiedere privilegi di root per installare i plugins; verifica che non sia giá installato sulla macchina ed eventualmente rimuovilo utilizzando un software manager.

Installa poi [Ruby Version Manager](https://rvm.io/){:target="_blank"}, o RVM, in modo da gestire le gemme in maniera semplice. Segui le [istruzioni di installazione](https://rvm.io/rvm/install){:target="_blank"} ed ottieni Ruby funzionante come utente semplice, senza dover inserire la password di root. 

Installa successivamente la versione piú recente di Ruby tramite

```
rvm install ruby-head
```

e verifica che l'installazione sia avvenuta correttamente nella `home`

```
which ruby

# /home/erpreciso/.rvm/rubies/ruby-2.4.0/bin/ruby
```

Installa poi Jekyll usando `bundle`

```
gem install jekyll bundler
```


## Crea il sito

A questo punto la piattaforma è completa per creare un nuovo sito web. Dato che l'obiettivo è quello di pubblicare in GitHub, nominalo come `<NOME DEL SITO>.github.io`. Usa il comando

```
jekyll new <NOME DEL SITO>.github.io
```

per creare la cartella e tutto il codice minimo per poter accendere il sito in locale.

Fai partire il server locale via

```
erpreciso@erpreciso-laptop:~/Dropbox/blog/erpreciso.github.io$ bundle exec jekyll serve

#  Configuration file: /home/erpreciso/Dropbox/blog/erpreciso.github.io/_config.yml
#  Configuration file: /home/erpreciso/Dropbox/blog/erpreciso.github.io/_config.yml
#              Source: /home/erpreciso/Dropbox/blog/erpreciso.github.io
#         Destination: /home/erpreciso/Dropbox/blog/erpreciso.github.io/_site
#   Incremental build: disabled. Enable with --incremental
#        Generating...
#  done in 1.858 seconds.
#   Auto-regeneration: enabled for '/home/erpreciso/Dropbox/blog/erpreciso.github.io'
#  Configuration file: /home/erpreciso/Dropbox/blog/erpreciso.github.io/_config.yml
#      Server address: http://127.0.0.1:4000/
#       Server running... press ctrl-c to stop.

```

Il sito sará ora disponibile aprendo un browser all'indirizzo [http://localhost:4000](http://localhost:4000){:target="_blank"}.

Dato che lo vuoi pubblicare in GitHub, collegati alla tua pagina di [github.com](https://github.com/){:target="_blank"} e crea una nuova repository con lo stesso nome del sito. Segui le istruzioni in github per poter collegare la cartella locale alla cartella remota:

```
# navigate to the folder, then:

$ git init
$ git add .
$ git commit -m "First commit"
$ git remote add origin <url of the github repository>
$ git push origin master

# verify
$ git remote -v

# origin	https://github.com/erpreciso/erpreciso.github.io.git (fetch)
# origin	https://github.com/erpreciso/erpreciso.github.io.git (push)
```

Jekyll utilizza il tema [minima](https://github.com/jekyll/minima){:target="_blank"} di default. 

Puoi personalizzarne intestazione, piè di pagina, corpo, navigazione, seguendo le istruzioni nel README.

Ad esempio, se vuoi aggiungere "Powered by Jekyll" nel piè di pagina, non serve altro che scaricare il file [footer.html](https://github.com/jekyll/minima/blob/master/_includes/footer.html){:target="_blank"} e salvarlo nella cartella `_include` per far sí che venga caricato al posto del default. Aggiungi poi la stringa dove desideri:

![Powered by Jekyll]({{ site.url }}/assets/images/uncategorized/poweredbyjekyll.png)

# Plugins

I [plugins disponibili per essere usati con GitHub pages](https://pages.github.com/versions/){:target="_blank"} non sono molti, ma in alternativa puoi installare i plugin in locale, costruire il sito e caricare in GitHub il sito giá costruito e presente in `_site`, invece che caricare la sorgente e farlo costruire a GitHub. Non tratteró questa opzione nell'articolo.

Il modo piú intuitivo per usare un plugin è quello di includerlo in `_config.yml` sotto la sezione `gems`, come viene riportato nella [guida di github](https://help.github.com/articles/adding-jekyll-plugins-to-a-github-pages-site/){:target="_blank"}:

{% highlight yaml %}
gems:
  - jekyll-sitemap
  - jekyll-seo-tag
{% endhighlight %}

e includerlo in `Gemfile`

{% highlight ruby %}
gem "jekyll-sitemap"
gem "jekyll-seo-tag"
{% endhighlight %}


# Aggiungi un'immagine

Per aggiungere un'immagine in un post è sufficiente inserire il [codice markdown](#ref_markdown) opportuno:

- punto esclamativo;
- testo alternativo racchiuso da parentesi quadre;
- collocazione del file immagine racchiuso da parentesi tonde.

In aggiunta, si puó racchiudere il tutto in un normale hyperlink in markdown per indirizzare ad un'immagine in dimensioni reali.

Ad esempio, questa riga genera l'immagine sottostante:

{% highlight markdown %}[![collegamenti sulla basetta sperimentale]({{ site.url }}/assets/images/mpu6050/breadboard_medium.png)]({{ site.url }}/assets/images/mpu6050/breadboard_big.jpg){% endhighlight %}

[![collegamenti sulla basetta sperimentale]({{ site.url }}/assets/images/mpu6050/breadboard_medium.png)]({{ site.url }}/assets/images/mpu6050/breadboard_big.jpg)


# Aggiungi excerpts e visualizzalo nell'indice

Jekyll utilizza come [excerpt](http://www.wordnik.com/words/excerpt){:target="_blank"} la prima riga di ogni post. Per poter invece definirlo separatamente dal testo, si puó usare YAML.

{% highlight yaml %}

---
title: Il mio post
excerpt: Introduzione del mio lavoro

---
{% endhighlight %}

Modificando il template utilizzato dal tema `minima` è possibile visualizzarlo nell'indice dei post.

- crea la cartella `_layout` nella directory contenente il sito;
- crea il file `home.html` copiandolo dalla [repository di minima](https://github.com/jekyll/minima/blob/master/_layouts/home.html){:target="_blank"};
- aggiungi il codice Liquid per visualizzare gli excerpt per ogni pagina, posto che è stato abilitato nella configurazione del sito.

{%highlight html %}{% raw %}
<ul class="post-list">
  {% assign posts=site.posts | where:"lang", page.lang %}
  {% for post in posts %}
    <li>
      {% assign date_format = site.minima.date_format | default: "%b %-d, %Y" %}
      <span class="post-meta">{{ post.date | date: date_format }}</span>

      <h2>
	<a class="post-link" href="{{ post.url | relative_url }}">{{ post.title | escape }}</a>
      </h2>

      <!-- sezione che visualizza l'excerpt -->
      {% if site.show_excerpts %}
      <div class="excerpt">{{ post.excerpt }}</div>
      {% endif %}
      <!-- fine sezione -->

    </li>
  {% endfor %}
</ul>
{% endraw %}{% endhighlight %}

# Customizza css

Sempre utilizzando i settaggi non default di `minima`, è possibile cambiare lo stile del sito modificando i files CSS, presenti in`_sass`.

Ad esempio, dato che ho aggiunto la nuova classe `title-tag` in un template, ne creo lo stile:
- in `_sass/minima.scss` creo una nuova variabile per definire un carattere grande in riferimento alla dimensione default

{% highlight css %}
$bigger-font-size:  $base-font-size * 1.125 !default;
{% endhighlight %}

- in `_sass/minima/_layout.scss` aggiungo il css desiderato

{% highlight css %}
/**
 * Tags
 **/
 .title-tag {
    font-size: $bigger-font-size;
 }
 .date-tag {
    color: $grey-color-dark;
    font-size: $small-font-size;
 }
{% endhighlight %}


# Supporta diverse lingue

Un plugin per supportare diverse lingue in github pages non esiste, ma puoi lavorare con YAML e Liquid per ottenere diverse versioni del sito in lingue diverse. Segui l'ottimo tutorial presente su [sylvaindurand.org](https://www.sylvaindurand.org/making-jekyll-multilingual/){:target="_blank"}.

Tutte le modifiche sono visualizzabili nella repository di questo sito, nel commit [`04ec450`](https://github.com/erpreciso/erpreciso.github.io/commit/04ec450afcb7bc1500bf463cea5d7d26a138cd4b){:target="_blank"}, e puoi verificare tutte le modifiche necessarie comparandolo con il commit [`bd4085f`](https://github.com/erpreciso/erpreciso.github.io/commit/bd4085fff190d3f1ad7f8e9d8ff341d82c722bd6){:target="_blank"}. 

Per semplicitá riporto la configurazione che ho seguito, con due lingue, italiano `it` ed inglese `en`.

Per prima cosa aggiungi, in `_config.yml`, un titolo ed una descrizione del sito nelle due lingue `en` e `it`

{% highlight diff %}
diff --git a/_config.yml b/_config.yml
index 7db2339..0fa9270 100644
--- a/_config.yml
+++ b/_config.yml
@@ -1,16 +1,16 @@
-title: All is not given is lost
+title:
+  it: Tutto ció che non è donato è perduto
+  en: All is not given is lost
 email: trepreciso@gmail.com
-description              : >
-  A collection of ideas, how-to and best practices 
-  that I consider worth sharing
+description:
+  en: A collection of ideas, how-to and best practices that I consider worth sharing
+  it: Idee, suggerimenti e guide che trovo utile condividere
{% endhighlight %}

Crea poi un file, `_data/vars.yml` dove salvare i linguaggi che vuoi includere

{% highlight diff %}
diff --git a/_data/vars.yml b/_data/vars.yml
new file mode 100644
index 0000000..e5c23dd
--- /dev/null
+++ b/_data/vars.yml
@@ -0,0 +1,14 @@
+languages:
+  - en
+  - it
{% endhighlight %}

Cerca poi, tramite {% highlight terminal %}grep -r site.title{% endhighlight %} tutti i file dove è presente il riferimento al titolo contenuto in `_config.yml`, e sostituisci `site.title` con `site.title[lang]`, che permette di selezionare il titolo in base al linguaggio della pagina corrente, definito nello YAML.

Ad esempio, questo è il nuovo titolo nel piè di pagina (`_includes/footer.html`)

{% highlight diff %}{% raw %}
diff --git a/_includes/footer.html b/_includes/footer.html
new file mode 100644
index 0000000..a5c000b
--- /dev/null
+++ b/_includes/footer.html
@@ -0,0 +1,46 @@
+
+    <h2 class="footer-heading">{{ site.title[page.lang] | escape }}</h2>
+
+      <div class="footer-col footer-col-3">
+        <p>{{ site.description[page.lang] | escape }}</p>
+      </div>
{% endraw %}{% endhighlight %}

Aggiungi, in `_includes/header.html`, i pulsanti per navigare nelle diverse versioni della stessa pagina, tramite il riferimento `ref` nello YAML di ogni pagina, costante nelle diverse versioni della stessa

{% highlight diff %}{% raw %}
diff --git a/_includes/header.html b/_includes/header.html
index c37b4e0..a96e06e 100644
--- a/_includes/header.html
+++ b/_includes/header.html
@@ -31,3 +31,10 @@
+<div class="wrapper" style="text-align: right; line-height: 2em">
+  {% assign posts=site.posts | where:"ref", page.ref | sort: 'lang' %}
+  {% for post in posts %} <a href="{{ post.url | prepend: site.baseurl }}" class="{{ post.lang }}">{{ post.lang }}</a> {% endfor %}
+
+  {% assign pages=site.pages | where:"ref", page.ref | sort: 'lang' %}
+  {% for page in pages %} <a href="{{ page.url | prepend: site.baseurl }}" class="{{ page.lang }}">{{ page.lang }}</a> {% endfor %}
+</div>
{% endraw %}{% endhighlight %}

In `_layouts/home.html`, modifica il generatore dei titoli dei post in modo che visualizzi solo quelli del linguaggio corrente:

{% highlight diff %}{% raw %}
diff --git a/_layouts/home.html b/_layouts/home.html
index 98701b2..1fa1f8b 100644
--- a/_layouts/home.html
+++ b/_layouts/home.html
@@ -1,15 +1,17 @@
-    {% for post in site.posts %}
+    {% assign posts=site.posts | where:"lang", page.lang %}
+    {% for post in posts %}
{% endraw %}{% endhighlight %}

Infine, ogni post va scritto due volte, assegnando un titolo a piacere, nella lingua corrente, includendo la tag `lang: ` con il linguaggio prescelto, mantenendo lo stesso `ref` nell'header, come mostrato qui.

{% highlight diff %}{% raw %}
diff --git a/_posts/2014-08-02-pamir-it.md b/_posts/2014-08-02-pamir-it.md
new file mode 100644
index 0000000..7207561
--- /dev/null
+++ b/_posts/2014-08-02-pamir-it.md
@@ -0,0 +1,246 @@
+---
+title: La generosita' e l'allegria dell'Asia centrale
+excerpt: "Brevi storie da un viaggio nel Gorno-Badakhshan, da Dushanbe (Tajikistan) ad Osh (Kyrghistan), passando per la valle Bartang ed il passo Kyzyl-Art"
+tags: viaggi
+lang: it
+ref: pamir
+
+---
{% endraw %}{% endhighlight %}

{% highlight diff %}{% raw %}

diff --git a/_posts/2014-08-02-pamir-en.md b/_posts/2014-08-02-pamir-en.md
new file mode 100644
index 0000000..c0ead3a
--- /dev/null
+++ b/_posts/2014-08-02-pamir-en.md
@@ -0,0 +1,17 @@
+---
+title: Goodness and happiness in Central Asia
+excerpt: Short stories from a trip in Gorno-Badakhshan, from Dushanbe (Tajikistan) to Osh (Kyrghistan), biking through the Bartang Valley and up the Kyzyl-Art pass
+tags: travel
+lang: en
+ref: pamir

+---
+
{% endraw %}{% endhighlight %}

Aggiungi del css per il selettore del linguaggio

{% highlight diff %}{% raw %}

diff --git a/_sass/minima/_layout.scss b/_sass/minima/_layout.scss
index d1f6a68..7ce1494 100644
--- a/_sass/minima/_layout.scss
+++ b/_sass/minima/_layout.scss
@@ -258,3 +258,12 @@
+
+/**
+ * Language selector
+ **/
+.en:lang(en), .it:lang(it){
+      font-weight: bold;
+      font-size: $bigger-font-size;
+    }
+
{% endraw %}{% endhighlight %}


# Aggiungi video YouTube

Per aggiungere facilmente video YouTube senza dover ogni volta costruire il frame, usa un template in `_include`.

## Crea il template

Crea un nuovo file, chiamato ad esempio `youtube.html`, ed incolla il codice che userai per visualizzare tutti i video YouTube che vorrai mettere sul sito.

{% highlight html %}
<style>
  .embed-container {
    position: relative;
    padding-bottom: 56.25%;
    height: 0;
    overflow: hidden;
    max-width: 100%;
  }
  .embed-container iframe,
  .embed-container object,
  .embed-container embed {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
</style>
<div class="embed-container">
  <iframe src="https://www.youtube.com/embed/{% raw %}{{ include.id }}{% endraw %}?fs=1&autoplay=0&loop=1&rel=0&border=0&modestbranding=1" frameborder="0" allowfullscreen="">
  </iframe>
</div>
{% endhighlight %}

Nel codice qui sopra, che è l'attuale template usato in questo sito per ogni video YouTube, è incluso il codice html che verrá automaticamente inserito ogni volta che ne faccio riferimento.

La stringa {% highlight liquid %}{% raw %}{{ include.id }}{% endraw %}{% endhighlight %} verrá sostituita, in fase di costruzione del sito, dal parametro `id` che passerai richiamando il template.

I parametri che seguono il punto interrogativo della url significano:

- `autoplay=0` non far partire il video automaticamente
- `loop=1` disattiva la ripetizione automatica
- `rel=0` nascondi i suggerimenti per video simili alla fine della riproduzione
- `border=0` rimuovi dei bordi
- `modestbranding=1` rimuovi il logo YouTube

## Richiama il template

Ogni qualvolta vuoi includere un video YouTube, includi nel post la stringa

{% highlight liquid %}
{% raw %}{% include youtube.html id="YOUTUBE ID" %}{% endraw %}
{% endhighlight %}

dove sostituirai `YOUTUBE ID` con l'id del video desiderato (ad esempio, se l'indirizzo del video è `https://www.youtube.com/watch?v=jgpJVI3tDbY`, l'id è <strong>`jgpJVI3tDbY`</strong> e la passerai racchiusa da virgolette doppie).

# Includi codice nei post

Per evidenziare il codice scritto in un post secondo la sintassi propria del linguaggio di programmazione, si puó usare il plugin preinstallato in Jekyll, [Rouge](https://github.com/jneen/rouge){:target="_blank"}.

La sintassi in liquid, ad esempio per Python, è

{% highlight liquid %}{% raw %}{% highlight python %}
def fib(n):    # write Fibonacci series up to n
    """Print a Fibonacci series up to n."""
    a, b = 0, 1
    while a < n:
        print(a, end=' ')
        a, b = b, a+b
    print()
{% endhighlight %}{% endraw %}{% endhighlight %}

che produce

{% highlight python %}
def fib(n):    # write Fibonacci series up to n
    """Print a Fibonacci series up to n."""
    a, b = 0, 1
    while a < n:
        print(a, end=' ')
        a, b = b, a+b
    print()
{% endhighlight %}

dove puoi sostituire `highlight python` con l'identificativo del linguaggio desiderato ottenibile dall'[elenco dei linguaggi supportati da Rouge](https://github.com/jneen/rouge/wiki/List-of-supported-languages-and-lexers){:target="_blank"}.



# Raccolta di riferimenti utili

- <a name="ref_liquid"></a>Linguaggio Liquid da [shopify.github.io/liquid](http://shopify.github.io/liquid/){:target="_blank"} e dalla [wiki](https://github.com/Shopify/liquid/wiki/Liquid-for-Designers){:target="_blank"};
- <a name="ref_markdown"></a>Linguaggio Markdown da [daringfireball.net](https://daringfireball.net/projects/markdown/syntax){:target="_blank"};
- <a name="ref_yaml"></a>Get started with YAML from [yaml.org](http://yaml.org/start.html){:target="_blank"}

