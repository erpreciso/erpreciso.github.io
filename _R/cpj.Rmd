---
title: "An analysis of the Cpj (Committee to Protect Journalists) database of journalists killed from 1992"
author: "Stefano Merlo"
date: 2016-11-16
output:
  md_document:
    variant: markdown_github

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Main findings

**Impunity**: there is an irrisory percentage (2.7%) of cases when everyone responsible of journalist's murders is convicted, including both perpetrators and masterminds.

**Deaths in Iraq not covering war**: 51% of journalists dead in Iraq after 2003 were not covering the war.


# Introduction

## Cpj, and the dataset

The Committee to Protect Journalists is an independent, nonprofit organization that promotes press freedom worldwide.

This dataset contains records of journalists deaths since 1992 where an investigation has been done, or it is in progress, to define whether a journalist's death was work-related.

Dataset, methodology and full terminology are available at [Cpj website](https://cpj.org/killed/).


## Weaknesses of this analysis

More cleaning of data would be required to pursue other in-depth analysis; as example:

- How is data accuracy over years? Are figures related to recent years comparable with those of earlier years?

- Only from 2003 CPJ started collecting data on media support workers: this can skew the numbers toward following years.

- In my analysis I considered "Unconfirmed" cases part of the population, differently than the analysis available on cpj website.



## Getting and cleaning data

Dataset is available in Kaggle [https://www.kaggle.com/cpjournalists/journalists-killed-worldwide-since-1992/downloads/journalists-killed-worldwide-since-1992.zip](https://www.kaggle.com/cpjournalists/journalists-killed-worldwide-since-1992/downloads/journalists-killed-worldwide-since-1992.zip).

I used **R** as analysis software, alongside the **tidyverse** packages and the **RStudio** platform.

```{r get-clean-data, echo = FALSE}
library(tidyverse)
d <- read.csv("~/Downloads/cpj.csv", na.strings = "") %>%
    tbl_df() %>%
    mutate(
        # clean Tortured and Threatened variables
        Threatened = stringr::str_replace(Threatened, "[\n]", ""),
        Tortured = stringr::str_replace(Tortured, "[\n]", ""),
        # extract Year from date
        Year = stringr::str_sub(Date, -4),
        Year = ifelse(stringr::str_detect(Year, "[1-2][0-9]{3}"),
                      Year,
                      ""),
        Year = as.numeric(Year),
        # add flag war yes/no based on presence of "war" string in coverage variable
        War = ifelse(grepl("War", Coverage),
                     "Was covering war",
                     "Was not covering war"))
```


# What were journalists covering?

In many cases journalists were not covering a single topic, therefore I disaggregated the variable; sum of bars is not equal to number of deaths.

```{r coverages, echo = FALSE}
plyr::laply(d$Coverage, function(x) stringr::str_split(x, ",")) %>%
    unlist %>%
    stringr::str_trim() %>%
    tbl_df %>%
    filter(value != "") %>%
    group_by(value) %>%
    dplyr::count() %>%
    mutate(r = rank(n)) %>%
    ggplot(aes(x = reorder(value, r), y = n)) +
    geom_bar(stat = "identity") +
    theme_minimal() +
    coord_flip() +
    labs(x = "Coverage",
         y = "Number of journalists killed that were covering this topic",
         title = "Number of deaths by coverage")
```

## Killed by country/year not in war coverage

I focus on cases where the journalist was not covering war.

```{r country-no-war, echo = FALSE}
d %>%
    filter(War == "Was not covering war") %>%
    group_by(Country_killed, Year) %>%
    dplyr::count() %>%
    arrange(desc(n)) %>%
    mutate(r = dplyr::min_rank(-n)) %>%
    filter(r <= 10) %>%
    dplyr::rename(Count = n) %>%
    select(-r)
```

Note the Philippines first result: this can be seen as [the worst loss of life of media professionals in one day in the history of journalism](http://www.gmanetwork.com/news/story/178575/news/nation/arroyo-declares-martial-law-in-maguindanao-province)

But it is interesting to note that, from this subset, 78 journalists in Iraq in 2004, 2006 and 2007 were not covering the war, that was [ongoing from 2003](https://en.wikipedia.org/wiki/Iraq_War)

## Iraq case: war coverage by year

The following graph plots deaths by year in Iraq: we can see that most of cases occur after the start of the war. We also see that there is a relevant percentage of cases where journalists weren't cover war.

```{r coverage-in-iraq, echo = FALSE}
d %>%
    filter(Country_killed == "Iraq",
           !is.na(Year)) %>%
    select(Year, War) %>%
    ggplot(aes(x = Year)) +
    geom_bar(aes(fill = War)) +
    theme_minimal() +
    scale_fill_brewer(palette = "Spectral",
                      direction = 1,
                      guide = guide_legend(title = "Coverage")) +
    labs(y = "Number of journalists killed", title = "Coverage by year in Iraq")

```

This can be better analysed by stacking the bars and then standardising each one to have the same height.

```{r proportions-coverage-iraq, echo = FALSE}
d %>%
    filter(Country_killed == "Iraq",
           !is.na(Year)) %>%
    select(Year, War) %>%
    ggplot(aes(x = Year)) +
    geom_bar(aes(fill = War), position = "fill") +
    theme_minimal() +
    scale_fill_brewer(palette = "Spectral",
                      direction = 1,
                      guide = guide_legend(title = "Coverage")) +
    labs(y = "Proportions of killed by coverage of war or not", title = "Coverage by year in Iraq")
```

Frequency table provides percentages by year ( but note that we lose here the weights on total number of deaths by year)

```{r iraq-war-freq-table, echo = FALSE}
d %>%
    filter(Country_killed == "Iraq") %>%
    select(Year, War) %>%
    group_by(Year, War) %>%
    dplyr::count() %>%
    filter(!is.na(Year)) %>%
    tidyr::spread(War, n, fill = 0) %>%
    mutate(`Was covering war` = `Was covering war` / sum(`Was covering war`, `Was not covering war`),
           `Was not covering war` = 1 - `Was covering war`) %>%
    mutate(`Was covering war` = scales::percent(`Was covering war`),
    `Was not covering war` = scales::percent(`Was not covering war`))
```

Total share of deaths while covering war in all years in Iraq is showed in this table:

```{r war-death-iraq, echo = FALSE}
x <- d %>%
    filter(Country_killed == "Iraq") %>%
    filter(!is.na(Year)) %>%
    select(War) %>%
    group_by(War) %>%
    dplyr::count() %>%
    mutate(freq = n / sum(n)) %>%
    filter(War == "Was not covering war") %>%
    select(freq)
not_covering_war <- scales::percent(x[[1]])

d %>%
    filter(Country_killed == "Iraq") %>%
    filter(!is.na(Year)) %>%
    select(War) %>%
    group_by(War) %>%
    dplyr::count() %>%
    mutate(freq = n / sum(n),
           freq = scales::percent(freq))

```

From this table we conclude that ```r not_covering_war``` of journalists were not covering war in Iraq at the time of their death.

# Who / What are causes of death?

From [Cpj's methodology](https://cpj.org/killed/terminology.php): "**Type of Death**: CPJ further categorizes each death in which the motive is confirmed. The categories are: **crossfire/combat** (a killing on a battlefield or in a military context); **dangerous assignment** (deaths while covering a demonstration, riot, clashes between rival groups, and mob situations); and **murder** (the targeted killing of a journalist, whether premeditated or spontaneous, in direct relation to the journalist's work)"

```{r typedeath-if-war, echo = FALSE}

d %>%
    mutate(War = ifelse(War, "He was covering war","He was NOT covering war")) %>%
    filter(!is.na(Type_death)) %>%
    ggplot() +
    geom_bar(aes(x = Type_death)) +
    facet_wrap(~ War) +
    theme_minimal() +
    coord_flip() + 
    labs(x = "Type of death",
         y = "Number of journalists killed",
         title = "Causes of death")
    
```

Not surprisingly, when war was covered a big cause of death were combat-related actions.

I will now focus on cases of murder.

## Murder perpetrators

Who are the murderers?

From [Cpj's methodology](https://cpj.org/killed/terminology.php): "**Suspected Perpetrators in Murder Cases**: This refers to the person or entity CPJ has identified as most likely responsible. Categories include: **political groups** (antigovernment parties or combatants, including insurgents and terrorists); **government officials** (civilian government officials, including police); **military officials** (members of the government's military); **paramilitary groups** (irregular armed forces allied with the government); **criminal groups** (criminals or members of criminal gangs); **mob violence** (crowds of people acting together but not otherwise organized); and **local residents** (individuals inspired to violence by news coverage).".

Since these are not always defined, in some cases there are multiple suspect perpretrators for a record; I will then create a list with all perpetrators with weights in case for a record there are multiple possibilities.

```{r murderers, echo = FALSE}
dd <- do.call(rbind.data.frame, d %>%
                  filter(!is.na(Source_fire)) %>%
                  apply(1, function(x){
                      g <- stringr::str_split(x["Source_fire"], ", ")
                      g <- g %>% unlist()
                      w <- 1 / length(g)
                      return(dplyr::data_frame(source = g,
                                               ws = w))
                  }))

# check that sum of weight is equal to number of cases of murder
stopifnot(sum(dd$ws) == nrow(d %>% filter(!is.na(Source_fire))))

dd %>%
    filter(!is.na(source)) %>%
    group_by(source) %>%
    dplyr::summarise(s = sum(ws)) %>%
    arrange(desc(s)) %>%
    mutate(r = rank(s)) %>%
    ggplot(aes(x = reorder(source, r), y = s)) + 
    geom_bar(stat = "identity") +
    coord_flip() +
    theme_minimal() +
    labs(y = "Number of murders attribuited, weighted in case of multiple assignment",
         x = "Suspected perpetrator",
         title = "Number of murders by suspected perpetrators")


```

Political groups are the biggest source of deaths for journalists.

# Impunity

From [Cpj's methodology](https://cpj.org/killed/terminology.php): "**Impunity in Murder Cases**: CPJ monitors the law enforcement and judicial process for each confirmed murder case, and we categorize the status of the investigation. The categories are: **complete impunity** (no convictions have been obtained); **partial justice** (some but not all of those responsible have been convicted; typically, assassins are convicted but not masterminds); and **full justice** (everyone responsible is convicted, including both perpetrators and masterminds)".

Impunity analysis on all countries may be little significative due to the amount of other variables outside this database: I will instead focus on countries with the higher number of murders.

In this dataset there are ```r d %>% filter(Type_death == "Murder") %>% nrow()``` cases of murder.

I will analyze them in relation to geographic area.

```{r murder-by-countries, echo = FALSE}
murder_countries <- d %>%
    filter(Type_death == "Murder") %>%
    tbl_df() %>%
    select(Country_killed) %>%
    group_by(Country_killed) %>%
    dplyr::count(sort = TRUE) %>%
    mutate(freq_percent = prop.table(n),
           cum = cumsum(freq_percent))

top_murder_countries <- murder_countries %>%
    filter(cum < 0.8)
```

Over ```r nrow(murder_countries)``` countries where cases of murder are present, only ```r nrow(top_murder_countries)``` contribute to the 80% of total cases. I will focus on these.

```{r impunity-by-country, echo = FALSE}
d_murder <- d %>%
    tbl_df() %>%
    # select countries with 80% of murder cases
    filter(Country_killed %in% top_murder_countries$Country_killed) %>%
    # filter for where impunity info is present
    filter(!is.na(Impunity_for_murder))

# create frequency table to order countries
s <- d_murder %>%
    select(Country_killed) %>%
    group_by(Country_killed) %>%
    dplyr::count(sort = TRUE) %>%
    tbl_df()

# join dataframe with frequency table
d_murder <- left_join(d_murder, s, by = "Country_killed")

# plot
d_murder %>%
    ggplot(aes(x = reorder(Country_killed, n))) +
    geom_bar(aes(fill = Impunity_for_murder)) +
    scale_fill_brewer(palette = "RdYlGn",
                      direction = -1,
                      guide = guide_legend(title = "Impunity")) +
    coord_flip() +
    theme_minimal() +
    labs(title = "Impunity for murders by country",
         x = "Number of murders",
         y = "Country")
```

From this data there is ```r d_murder %>% select(Impunity_for_murder) %>% group_by(Impunity_for_murder) %>% dplyr::count() %>% mutate(p = prop.table(n)) %>% filter(Impunity_for_murder == "No") %>% mutate(p = scales::percent(p)) %>% select(p)``` possibility to have justice after a murder case.

## Is there variation of impunity over time? Focus on the 3 deadliest countries.

Is the impunity changing over time? I will focus on the 3 deadliest countries for clarity of representation.

```{r impunity-function, eco = FALSE}
plot_impunity <- function(country_index){
    c <- murder_countries[country_index, "Country_killed"][[1]] %>% as.character()
    d %>%
        tbl_df() %>%
        filter(Country_killed == c,
               !is.na(Impunity_for_murder),
               !is.na(Year)) %>%
        select(Country_killed, Year, Impunity_for_murder) %>%
        ggplot(aes(x = Year)) +
        geom_bar(aes(fill = Impunity_for_murder)) +
        scale_fill_brewer(palette = "RdYlGn",
                          direction = -1,
                          guide = guide_legend(title = "Impunity")) +
        theme_minimal() +
        labs(title = paste("Impunity for murders in", c),
             y = "Number of murders",
             x = "Year")
}
```

### Iraq

```{r impunity-iraq, echo=FALSE}
plot_impunity(1)
```

### Philippines

```{r impunity-philippines, echo=FALSE}
plot_impunity(2)
```

### Algeria

```{r impunity-algeria, echo=FALSE}
plot_impunity(3)
```

There are so few solved murderes that a plot over time is not meaningful.

## Impunity related to suspect perpetrators

How is impunity related to who is suspected to have committed the crime?

```{r impunity-by-perpetrator, echo = FALSE}
# since there may be multiple possible perpetrators for each case,
# I will create a list with all perpetrators with weights in case
# for a record there are multiple possibilities

dd <- do.call(rbind.data.frame, d %>%
                  filter(!is.na(Impunity_for_murder),
                         Type_death == "Murder") %>%
                  apply(1, function(x){
                      g <- stringr::str_split(x["Source_fire"], ", ")
                      g <- g %>% unlist()
                      w <- 1 / length(g)
                      return(dplyr::data_frame(source = g,
                                               impunity = x["Impunity_for_murder"],
                                               ws = w))
                  }))

# check that sum of weight is equal to number of cases of murder
stopifnot(sum(dd$ws) == nrow(d %>% filter(!is.na(Impunity_for_murder),
                                          Type_death == "Murder")))

dd %>%
    filter(!is.na(source)) %>%
    group_by(source, impunity) %>%
    dplyr::summarise(s = sum(ws)) %>%
    ggplot(aes(x = source, y = s)) + 
    geom_bar(aes(fill = impunity), stat = "identity", position = "fill") +
    coord_flip() +
    theme_minimal() +
    scale_fill_brewer(palette = "RdYlGn",
                      direction = -1,
                      guide = guide_legend(title = "Impunity")) +
    labs(y = "Number of murders",
         x = "Suspected perpetrator",
         title = "Impunity shares for suspected perpetrators")

```

It seems that impunity is lowest when the murders come from local residents, and is max when there are political groups or unknown fire as source of death.

# Conclusion

While I focused my analysis on impunity for murder and on coverage in Iraq, the datasets can offer several other analysis ideas, some of them I started in my exploratory analysis.

I also highlighted some possible flaws of my analysis, therefore data methodology and terminology must be carefully ponderated when extrapolating results, since can lead to wrong interpretations.
